:root{
  --bg:#fefefe;
  --surface:#ffffff;
  --border:#f1f3f4;
  --border-light:#f8f9fa;
  --text-primary:#0a0a0a;
  --text-secondary:#5f6368;
  --text-muted:#9aa0a6;
  --accent:#4285f4;
  --accent-hover:#3367d6;
  --success:#34a853;
  --warning:#fbbc04;
  --danger:#ea4335;
  --shadow-xs:0 1px 2px 0 rgba(60,64,67,0.3),0 1px 3px 1px rgba(60,64,67,0.15);
  --shadow-sm:0 1px 2px 0 rgba(60,64,67,0.3),0 2px 6px 2px rgba(60,64,67,0.15);
  --shadow:0 1px 3px 0 rgba(60,64,67,0.3),0 4px 8px 3px rgba(60,64,67,0.15);
  --shadow-lg:0 2px 6px 2px rgba(60,64,67,0.15),0 8px 24px 4px rgba(60,64,67,0.15);
  --radius:4px;
  --radius-lg:6px;
  --filter-bg:#ffeaa7;
  --record-bar-bg:#e3f2fd;
}
*{box-sizing:border-box;}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background:var(--bg);color:var(--text-primary);line-height:1.4;font-size:13px;font-weight:400;}
button{border:none;border-radius:var(--radius);padding:6px 12px;font-weight:500;cursor:pointer;font-size:13px;transition:all 0.1s ease;font-family:inherit;height:32px;display:inline-flex;align-items:center;justify-content:center;}
.header{background:var(--surface);color:var(--text-primary);display:flex;justify-content:space-between;align-items:center;padding:12px 20px;font-weight:400;position:relative;border-bottom:1px solid var(--border-light);box-shadow:var(--shadow-xs);}
.header-left{display:flex;flex-direction:column;gap:8px;flex:1;}
.header-title{font-size:20px;font-weight:700;color:#b87333;letter-spacing:-0.02em;text-shadow:1px 1px 2px rgba(0,0,0,0.1);margin:0;}
.header-buttons{display:flex;gap:8px;align-items:center;}
.header-right{display:flex;align-items:center;}
.dropdown{position:relative;display:inline-block;}
.dropdown-content{display:none;position:absolute;background-color:var(--surface);min-width:140px;box-shadow:0 4px 8px rgba(0,0,0,0.1);border-radius:4px;z-index:1000;top:100%;left:0;margin-top:4px;overflow:hidden;}
.dropdown-content button{display:flex;width:100%;border:none;background:none;padding:8px 12px;text-align:left;cursor:pointer;transition:background 0.2s;justify-content:flex-start;border-radius:0;}
.dropdown-content button:hover{background:var(--bg);}
.dropdown-content.show{display:block;}
button.black,button.primary{background:var(--text-primary);color:var(--surface);}
button.black:hover,button.primary:hover{background:#2d2d2d;box-shadow:var(--shadow-xs);}
button.pdf{background:var(--accent);color:var(--surface);}
button.pdf:hover{background:var(--accent-hover);box-shadow:var(--shadow-xs);}
button.excel{background:var(--success);color:var(--surface);}
button.excel:hover{background:#2e7d32;box-shadow:var(--shadow-xs);}
button.danger{background:var(--danger);color:var(--surface);}
button.danger:hover{background:#c62828;box-shadow:var(--shadow-xs);}
button.danger:disabled{opacity:0.5;cursor:not-allowed;}

/* Theme Switch */
.theme-switch{position:relative;width:44px;height:22px;}
.theme-switch input{opacity:0;width:0;height:0;}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:22px;}
.slider:before{position:absolute;content:"";height:18px;width:18px;left:2px;bottom:2px;background-color:white;transition:.4s;border-radius:50%;}
input:checked + .slider{background-color:#4285f4;}
input:checked + .slider:before{transform:translateX(22px);}

/* Dark Theme */
body.dark{--bg:#1a1a1a;--surface:#2d2d2d;--border:#404040;--border-light:#333333;--text-primary:#ffffff;--text-secondary:#b3b3b3;--text-muted:#808080;--accent:#5a9fd4;--accent-hover:#4a8bc4;--success:#4caf50;--warning:#ff9800;--danger:#f44336;--filter-bg:#3d3a2a;--record-bar-bg:#2a3a4d;}
.filter-card,.table-card,.record-count-bar{max-width:1400px;margin:16px auto;padding:0 20px;}
.filter-card{background:var(--filter-bg);border:1px solid var(--border-light);border-radius:var(--radius-lg);padding:16px;box-shadow:var(--shadow-xs);}
.record-count-bar{background:var(--record-bar-bg);border:1px solid var(--border-light);border-radius:var(--radius-lg);padding:8px 16px;font-weight:500;max-width:1400px;margin:8px auto;color:var(--text-primary);display:flex;justify-content:space-between;align-items:center;}
.record-count-bar span:first-child{font-weight:500;}
.filter-grid{display:grid;grid-template-columns:1.5fr 0.8fr 1fr 0.9fr 0.9fr 1fr 1fr 0.8fr 1fr;gap:10px;align-items:stretch;}
.filter-labels{font-size:11px;font-weight:500;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.08em;margin-bottom:6px;}
input[type="search"],input[type="date"],select{padding:8px 12px;border:1px solid var(--border);border-radius:var(--radius);width:100%;height:36px;box-sizing:border-box;font-size:13px;background:var(--surface);transition:all 0.1s ease;font-family:inherit;color:var(--text-primary);}
input[type="search"]:focus,input[type="date"]:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(66,133,244,0.1);}
#btnClear{background:var(--text-primary);color:var(--surface);height:32px;box-sizing:border-box;padding:6px 12px;border:1px solid var(--text-primary);border-radius:var(--radius);width:100%;font-weight:500;font-size:13px;}
.table-card{background:var(--surface);border:1px solid var(--border-light);border-radius:var(--radius-lg);box-shadow:var(--shadow-xs);position:relative;max-height:calc(100vh - 200px);min-height:500px;overflow:hidden;}
.table-header-space{height:30px;position:relative;z-index:20;}
.table-scroll-wrapper{height:17px;overflow-x:scroll!important;overflow-y:hidden;position:absolute;top:240px;left:0;right:17px;z-index:25;background:var(--border-light);border-top:2px solid var(--text-muted);border-bottom:2px solid var(--text-muted);display:block!important;visibility:visible!important;}
.table-scroll-wrapper::-webkit-scrollbar{height:17px;display:block!important;}
.table-scroll-wrapper::-webkit-scrollbar-track{background:var(--border-light);}
.table-scroll-wrapper::-webkit-scrollbar-thumb{background:var(--text-muted);border-radius:4px;}
.table-scroll-wrapper::-webkit-scrollbar-thumb:hover{background:var(--text-secondary);}
.table-data-wrapper{position:absolute;top:0;left:0;right:0;bottom:0;overflow-x:scroll;overflow-y:auto;padding-top:30px;}
.table-data-wrapper::-webkit-scrollbar{width:17px;height:17px;}
.table-data-wrapper::-webkit-scrollbar:horizontal{display:none;}
.table-data-wrapper::-webkit-scrollbar-track{background:var(--border-light);}
.table-data-wrapper::-webkit-scrollbar-thumb{background:var(--text-muted);border-radius:4px;}
table{width:1200px;border-collapse:collapse;table-layout:fixed;min-width:1200px;max-width:1200px;position:relative;}
thead{position:absolute;top:0;left:0;right:0;z-index:15;background:var(--bg);display:table;width:1200px;}
tbody{display:block;margin-top:30px;}
tbody tr{display:table;width:1200px;table-layout:fixed;}
th:last-child,td:last-child{width:80px!important;min-width:80px!important;max-width:80px!important;}
th,td{padding:8px 12px;border-bottom:1px solid var(--border-light);font-size:12px;color:var(--text-primary);}
th{background:#ffeaa7;font-weight:700;font-size:11px;position:relative;user-select:none;text-align:center;color:var(--text-primary);text-transform:capitalize;letter-spacing:0.08em;}
th:nth-child(1),td:nth-child(1),
th:nth-child(2),td:nth-child(2),
th:nth-child(3),td:nth-child(3){text-align:left;}
td:not(:nth-child(1)):not(:nth-child(2)):not(:nth-child(3)){text-align:center;}
tr:hover{background:var(--bg);}
th.resizable::after{content:"";position:absolute;right:0;top:0;width:2px;height:100%;background:var(--border);cursor:col-resize;opacity:0;}
th.resizable:hover::after{opacity:1;background:var(--text-muted);}
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.4);backdrop-filter:blur(2px);align-items:center;justify-content:center;}
.modal-content{background:var(--filter-bg);padding:24px;border-radius:var(--radius-lg);width:90%;max-width:700px;max-height:90vh;overflow-y:auto;box-shadow:var(--shadow);border:1px solid var(--border-light);position:relative;}
.modal-content h3{font-size:16px;font-weight:500;color:var(--text-primary);margin:0 0 20px 0;text-align:left;letter-spacing:-0.01em;}
.row{display:flex;gap:12px;margin-bottom:16px;}
.row-full{display:flex;flex-direction:column;margin-bottom:16px;}
.row4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:16px;}
.row2{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:16px;}
.row1{display:grid;grid-template-columns:1fr;gap:16px;margin-bottom:16px;}
.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:16px;max-width:100%;}
.row-snippets{display:flex;gap:10px;margin-bottom:16px;align-items:flex-end;}
.desc-section{display:flex;flex-direction:column;flex:1.5;}
.snippets-section{display:flex;flex-direction:column;flex:1.5;}
.snippets-controls{display:flex;gap:5px;}
.snippets-controls select{flex:1;min-width:100px;}
.snippets-controls button{white-space:nowrap;}
.tip-text{font-size:11px;color:var(--text-secondary);margin-top:4px;font-style:italic;}
.btn-save-snippet{background:var(--accent);color:var(--surface);padding:6px 12px;border-radius:var(--radius);font-weight:500;font-size:13px;border:none;cursor:pointer;transition:all 0.1s ease;}
.btn-save-snippet:hover{background:var(--accent-hover);box-shadow:var(--shadow-xs);}
.row3>div{display:flex;flex-direction:column;}
.row4>div{display:flex;flex-direction:column;}
.row2>div{display:flex;flex-direction:column;}
.row1>div{display:flex;flex-direction:column;}
label{font-size:12px;font-weight:500;margin-bottom:4px;display:block;color:var(--text-primary);letter-spacing:0;}
input,select{width:100%;padding:8px 12px;border:1px solid var(--border);border-radius:var(--radius);font-size:13px;background:var(--surface);transition:all 0.1s ease;box-sizing:border-box;height:36px;font-family:inherit;color:var(--text-primary);}
input:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(66,133,244,0.1);}
.modal-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:24px;padding-top:16px;border-top:1px solid var(--border-light);}
#saveBtn{background:var(--accent);color:var(--surface);padding:8px 16px;border-radius:var(--radius);font-weight:500;font-size:13px;border:none;cursor:pointer;transition:all 0.1s ease;min-width:80px;height:32px;}
#saveBtn:hover{background:var(--accent-hover);box-shadow:var(--shadow-xs);}
#cancelBtn{background:var(--surface);color:var(--text-secondary);padding:8px 16px;border-radius:var(--radius);font-weight:500;font-size:13px;border:1px solid var(--border);cursor:pointer;transition:all 0.1s ease;min-width:80px;height:32px;}
#cancelBtn:hover{background:var(--bg);border-color:var(--text-muted);color:var(--text-primary);}


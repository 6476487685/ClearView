<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Bank Accounts</title>
  <link rel="stylesheet" href="8_Manage_Bank_Ac_Style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="10_Global_Master_Data_Export.js"></script>
</head>

<body>
  <header class="header">
    <div class="header-left">
      <h1 class="header-title">Manage Bank Accounts</h1>
      <button class="black header-back-button" onclick="window.location.href='index.html'">‚Üê Back to Main Dashboard</button>
    </div>
    <div class="header-right">
      <div class="auto-backup-control" title="Toggle automatic Excel backups">
        <span class="status" id="autoBackupStatusText">Auto Backup: Paused</span>
        <label class="toggle-switch">
          <input type="checkbox" id="autoBackupToggle">
          <span class="slider"></span>
        </label>
      </div>
      <div class="header-right-actions">
        <button class="primary" id="btnManualBackup">üíæ Backup Now</button>
        <button class="excel" id="btnExportPDF">üìò Export All Records</button>
      </div>
    </div>
  </header>

  <main>
    <!-- Account Tag Highlight Bar -->
    <section class="account-tag-bar" id="accountTagBar">
      <div class="account-tag-content">
        <label>Account Tag:</label>
        <select id="accountTagSelect"></select>
        <button class="primary" id="btnAddRecord">‚ûï Add Bank Account</button>
      </div>
    </section>

    <!-- Bank Records Container -->
    <section class="bank-records-container" id="bankRecordsContainer">
      <!-- Records will be dynamically added here -->
    </section>
  </main>

  <!-- Bank Record Modal -->
  <div id="bankModal" class="modal">
    <div class="modal-content bank-modal-content">
      <h3 id="modalTitle">Add Bank Account</h3>
      <form id="bankForm">
        <!-- Row 1: Institution (Bank Name), Country, Branch Address, Account Tag -->
        <div class="row2" style="grid-template-columns: 0.8fr 0.8fr 2.4fr 2fr; gap: 12px;">
          <div>
            <label>Bank</label>
            <select id="Bank_Institution" required></select>
          </div>
          <div>
            <label>Country</label>
            <select id="Bank_Country">
              <option value="">Select Country</option>
              <option value="India">India</option>
              <option value="Canada">Canada</option>
              <option value="US">US</option>
            </select>
          </div>
          <div>
            <label>Branch Address</label>
            <input type="text" id="Bank_Branch_Address" placeholder="123 Main St, Halifax, NS">
          </div>
          <div>
            <label>Account Tag</label>
            <select id="Bank_Ac_Tag" required></select>
          </div>
        </div>

        <!-- Row 2: Account Status, Account Type, Account Number -->
        <div class="row2" style="grid-template-columns: 1fr 1fr 1.5fr; gap: 12px;">
          <div>
            <label>Account Status</label>
            <select id="Bank_Account_Status">
              <option value="">Select Account Status</option>
            </select>
          </div>
          <div>
            <label>Account Type (Ac_Type)</label>
            <select id="Bank_Ac_Type" required></select>
          </div>
          <div>
            <label>Account Number</label>
            <input type="text" id="Bank_Account_Number" placeholder="123456789012">
          </div>
        </div>

        <!-- Row 3: Transit# | SWIFT | IFSC, Institution# | MICR, Minimum Balance Required -->
        <div class="row2" style="grid-template-columns: 1fr 0.7fr 2.3fr; gap: 12px;">
          <div>
            <label>Transit# | SWIFT | IFSC</label>
            <input type="text" id="Bank_Transit_IFSC" placeholder="12345 | xxxxxxxx | ADCD0123456">
          </div>
          <div>
            <label>Institution# | MICR</label>
            <input type="text" id="Bank_Institution_MICR" placeholder="0003 / 123456789">
          </div>
          <div>
            <label>Minimum Balance Required</label>
            <input type="text" id="Bank_Min_Balance" placeholder="0.00">
          </div>
        </div>

        <!-- Holder Count Selection -->
        <div class="row-full">
          <label>Number of Holders (1-4)</label>
          <select id="Bank_Holder_Count" required>
            <option value="1">1 Holder</option>
            <option value="2">2 Holders</option>
            <option value="3">3 Holders</option>
            <option value="4">4 Holders</option>
          </select>
        </div>

        <!-- Dynamic Holders Section -->
        <div id="holdersContainer"></div>

        <!-- Nomination Section -->
        <div class="section-divider">Nomination</div>
        <div class="holder-section">
          <h4>Nominee</h4>
          <div class="holder-row">
            <div>
              <label>Nominee (Ac_Holder)</label>
              <select id="Bank_Nominee_Name"></select>
            </div>
            <div>
              <label>Nominee Name</label>
              <input type="text" id="Bank_Nominee_Name_Text" placeholder="Will auto-fill from dropdown">
            </div>
            <div>
              <label>Nominee_Email</label>
              <select id="Bank_Nominee_Email"></select>
            </div>
            <div>
              <label>Nominee_Phone</label>
              <select id="Bank_Nominee_Phone"></select>
            </div>
          </div>
        </div>

        <!-- Helpline Section -->
        <div class="section-divider">Helpline</div>
        <div class="helpline-grid">
          <div>
            <label>Helpline Phones</label>
            <textarea id="Bank_Helpline_Phone" rows="4" placeholder="Add up to 4 numbers, one per line"></textarea>
          </div>
          <div>
            <label>Helpline Emails</label>
            <textarea id="Bank_Helpline_Email" rows="4" placeholder="Add up to 4 addresses, one per line"></textarea>
          </div>
        </div>
        <div class="row-full">
          <label>URL</label>
          <input type="url" id="Bank_Helpline_URL" placeholder="https://">
        </div>

        <!-- Notes Section -->
        <div class="section-divider">Notes</div>
        <div class="row-full">
          <label>Notes</label>
          <textarea id="Bank_Notes" rows="4"></textarea>
        </div>

        <!-- Security Questions Section -->
        <div class="section-divider">Security Questions (Optional)</div>
        <div class="security-grid">
          <div class="security-item">
            <label>Question 1</label>
            <select id="Bank_Security_Q1"></select>
            <label>Answer 1</label>
            <input type="text" id="Bank_Security_A1" class="sqa-answer" readonly>
          </div>
          <div class="security-item">
            <label>Question 2</label>
            <select id="Bank_Security_Q2"></select>
            <label>Answer 2</label>
            <input type="text" id="Bank_Security_A2" class="sqa-answer" readonly>
          </div>
          <div class="security-item">
            <label>Question 3</label>
            <select id="Bank_Security_Q3"></select>
            <label>Answer 3</label>
            <input type="text" id="Bank_Security_A3" class="sqa-answer" readonly>
          </div>
          <div class="security-item">
            <label>Question 4</label>
            <select id="Bank_Security_Q4"></select>
            <label>Answer 4</label>
            <input type="text" id="Bank_Security_A4" class="sqa-answer" readonly>
          </div>
          <div class="security-item">
            <label>Question 5</label>
            <select id="Bank_Security_Q5"></select>
            <label>Answer 5</label>
            <input type="text" id="Bank_Security_A5" class="sqa-answer" readonly>
          </div>
          <div class="security-item">
            <label>Question 6</label>
            <select id="Bank_Security_Q6"></select>
            <label>Answer 6</label>
            <input type="text" id="Bank_Security_A6" class="sqa-answer" readonly>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" id="cancelBtn">Cancel</button>
          <button type="submit" id="saveBtn">Save</button>
        </div>
      </form>
    </div>
  </div>

  <script src="8_Manage_Bank_Ac_Main.js"></script>
  <script>
    // Theme Switch
    const themeSwitch = document.getElementById('themeSwitch');
    const savedTheme = localStorage.getItem('bankTheme') || 'light';
    if (savedTheme === 'dark') {
      document.body.classList.add('dark');
      themeSwitch.checked = true;
    }
    themeSwitch.addEventListener('change', () => {
      document.body.classList.toggle('dark');
      localStorage.setItem('bankTheme', themeSwitch.checked ? 'dark' : 'light');
    });
  </script>
  <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>
</body>
</html>


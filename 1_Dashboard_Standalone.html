<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ClearView 1.0 — Transaction Manager</title>
<style>
:root {
 --header-bg:linear-gradient(135deg, #667eea 0%, #764ba2 100%);--sidebar-bg:#f8fafc;--content-bg:#ffffff;--primary-bg:#f1f5f9;
 --accent-blue:#3b82f6;--accent-blue-hover:#2563eb;--accent-gold:#f59e0b;
 --text-body:#1e293b;--divider:#e2e8f0;--shadow:0 4px 6px -1px rgba(0,0,0,0.1);
 --gradient-primary:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
body.dark {
 --header-bg:linear-gradient(135deg, #1e293b 0%, #334155 100%);--sidebar-bg:#1e293b;--content-bg:#0f172a;--primary-bg:#0f172a;
 --accent-blue:#60a5fa;--accent-blue-hover:#3b82f6;--accent-gold:#fbbf24;
 --text-body:#f1f5f9;--divider:#334155;--shadow:0 4px 6px -1px rgba(0,0,0,0.3);
}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background:var(--primary-bg);color:var(--text-body);line-height:1.6;}
header{
 height:60px;background:var(--header-bg);border-bottom:1px solid var(--divider);
 display:flex;align-items:center;justify-content:space-between;
 padding:0 20px;position:fixed;top:0;left:0;right:0;z-index:1000;
 box-shadow:var(--shadow);
}
header h1{margin:0;font-size:1.4rem;font-weight:700;flex:1;text-align:center;display:flex;justify-content:center;align-items:center;gap:8px;color:#ffffff;text-shadow:0 2px 4px rgba(0,0,0,0.1);}
.theme-switch{position:relative;width:44px;height:22px;}
.theme-switch input{opacity:0;width:0;height:0;}
.slider{
 position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;
 background-color:#ccc;transition:.4s;border-radius:34px;
}
.slider:before{
 position:absolute;content:"";height:16px;width:16px;left:3px;bottom:3px;
 background-color:white;transition:.4s;border-radius:50%;
}
input:checked + .slider{background-color:var(--accent-blue);}
input:checked + .slider:before{transform:translateX(22px);}
#logoutBtn{
 background:linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
 color:#fff;border:1px solid rgba(255,255,255,0.2);padding:10px 18px;border-radius:12px;
 font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 backdrop-filter:blur(15px);box-shadow:0 4px 15px rgba(0,0,0,0.1);font-size:0.9rem;position:relative;overflow:hidden;
}
#logoutBtn::before{
 content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
 background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
 transition:left 0.5s;
}
#logoutBtn:hover{
 background:linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.1) 100%);
 border-color:rgba(255,255,255,0.4);transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.15);
}
#logoutBtn:hover::before{left:100%;}
#logoutBtn:active{transform:translateY(0px);box-shadow:0 2px 10px rgba(0,0,0,0.1);}
#sidebar{
 position:fixed;top:60px;left:0;width:260px;bottom:0;background:var(--sidebar-bg);
 border-right:1px solid var(--divider);overflow-y:auto;padding:20px 15px;box-shadow:var(--shadow);
}
.nav-link{display:block;padding:12px 16px;margin:4px 0;border-radius:8px;text-decoration:none;color:var(--text-body);transition:all 0.3s ease;font-weight:500;}
.nav-link:hover{background:var(--accent-blue);color:#fff;transform:translateX(4px);box-shadow:var(--shadow);}
.nav-link.disabled{opacity:.5;pointer-events:none;}
.nav-link span.icon{margin-right:10px;font-size:1.1em;}
#content{margin-left:260px;margin-top:60px;padding:30px;min-height:calc(100vh - 60px);}
.modal{
 display:none;position:fixed;z-index:2000;left:0;top:0;width:100%;height:100%;
 background-color:rgba(0,0,0,0.4);
}
.modal-content{
 background:var(--content-bg);margin:10% auto;padding:30px;border:1px solid var(--divider);
 width:80%;max-width:600px;border-radius:12px;animation:fadein .25s;box-shadow:var(--shadow);
}
@keyframes fadein{from{opacity:0;transform:translateY(-20px);}to{opacity:1;transform:translateY(0);}}
.close{float:right;font-size:20px;font-weight:bold;cursor:pointer;}
.table thead{background:var(--accent-blue);color:#fff;}
.table td,.table th{padding:6px 10px;border-bottom:1px solid var(--divider);}
</style>
</head>
<body>
<header>
  <label class="theme-switch"><input type="checkbox" id="themeSwitch"><span class="slider"></span></label>
  <h1>🔍 ClearView 1.0</h1>
  <button id="logoutBtn">🚀 Sign Out</button>
</header>

<nav id="sidebar">
  <a href="#" class="nav-link" data-target="masters"><span class="icon">🧩</span>Manage Master Data</a>
  <a href="#" class="nav-link" data-target="tasks"><span class="icon">✅</span>Manage Tasks</a>
  <a href="#" class="nav-link" data-target="accounts"><span class="icon">🗂️</span>Manage Accounts</a>
  <a href="#" class="nav-link" data-target="load"><span class="icon">📁</span>Load Local Data</a>
  <a href="#" class="nav-link disabled" title="Coming soon"><span class="icon">☁️</span>Google Drive</a>
  <a href="#" class="nav-link disabled" title="Standalone Mode - No Expense Link"><span class="icon">💸</span>Expense Transactions</a>
  <a href="#" class="nav-link" data-target="income"><span class="icon">💰</span>Income Transactions</a>
  <a href="#" class="nav-link" data-target="investments"><span class="icon">📈</span>Investments</a>
  <a href="#" class="nav-link" data-target="analytics"><span class="icon">📊</span>Analytics</a>
  <a href="#" class="nav-link" data-target="backup"><span class="icon">💾</span>Backup & Export</a>
  <a href="#" class="nav-link" data-target="docs"><span class="icon">📑</span>Documents</a>
</nav>

<main id="content"></main>

<!-- ========== MODALS ========== -->
<!-- Load Local Modal -->
<div id="modal-load" class="modal">
  <div class="modal-content">
    <span class="close" data-close="modal-load">&times;</span>
    <h4>📁 Load Local Data</h4>
    <p>Supported formats: <b>.xlsx .json .sqlite .db</b></p>
    <input type="file" id="fileInput" accept=".xlsx,.json,.sqlite,.db" hidden>
    <button id="btnLoadLocal">Choose File…</button>
    <p class="small">After loading, data persists in localStorage.</p>
  </div>
</div>

<!-- Documents Modal -->
<div id="modal-docs" class="modal">
  <div class="modal-content">
    <span class="close" data-close="modal-docs">&times;</span>
    <h4>📑 Documents Section</h4>
    <input type="file" id="docUpload">
    <table class="table" width="100%">
      <thead><tr><th>Name</th><th>Type</th><th>Size</th><th>Added</th><th>Actions</th></tr></thead>
      <tbody id="docsTbody"></tbody>
    </table>
  </div>
</div>

<!-- Placeholder Modal (used for all other menu items) -->
<div id="modal-generic" class="modal">
  <div class="modal-content">
    <span class="close" data-close="modal-generic">&times;</span>
    <h4 id="genericTitle"></h4>
    <p>Coming soon…</p>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
/* ---------- Theme ---------- */
const themeSwitch=document.getElementById('themeSwitch');
const savedTheme=localStorage.getItem('theme')||'light';
if(savedTheme==='dark'){document.body.classList.add('dark');themeSwitch.checked=true;}
themeSwitch.addEventListener('change',()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('theme',themeSwitch.checked?'dark':'light');
});

/* ---------- Logout ---------- */
document.getElementById('logoutBtn').addEventListener('click',()=>{
  if(confirm('Are you sure you want to logout?')) location.reload();
});

/* ---------- Modal Logic ---------- */
function openModal(id){
  document.getElementById(id).style.display='block';
}
function closeModal(id){
  document.getElementById(id).style.display='none';
}
document.querySelectorAll('.close').forEach(x=>x.onclick=()=>closeModal(x.dataset.close));
window.onclick=function(e){
  document.querySelectorAll('.modal').forEach(m=>{if(e.target===m)m.style.display='none';});
};

/* ---------- Sidebar Clicks ---------- */
document.querySelectorAll('.nav-link').forEach(link=>{
  link.addEventListener('click',e=>{
    e.preventDefault();
    const t=link.dataset.target;
    if(!t) return;
    if(t==='load'){openModal('modal-load');}
    else if(t==='docs'){openModal('modal-docs');}
    else if(['masters','tasks','accounts','income','investments','analytics','backup'].includes(t)){
      document.getElementById('genericTitle').textContent=link.textContent;
      openModal('modal-generic');
    }
  });
});

/* ---------- Load Local ---------- */
const btnLoad=document.getElementById('btnLoadLocal');
const fileInput=document.getElementById('fileInput');
btnLoad.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',async e=>{
  const f=e.target.files[0];if(!f)return;
  const n=f.name.toLowerCase();
  if(n.endsWith('.json')){
    const txt=await f.text();localStorage.setItem('txnData',txt);
    alert('JSON data loaded!');
  }else if(n.endsWith('.xlsx')){
    const buf=await f.arrayBuffer();const wb=XLSX.read(buf);
    const js=JSON.stringify(wb.Sheets);localStorage.setItem('txnData',js);
    alert('Excel data loaded!');
  }else{alert('SQLite placeholder — coming soon.');}
});

/* ---------- Documents ---------- */
const docUpload=document.getElementById('docUpload');
const docsTbody=document.getElementById('docsTbody');
let docs=JSON.parse(localStorage.getItem('docsList')||'[]');
renderDocs();
docUpload.addEventListener('change',e=>{
  const f=e.target.files[0];if(!f)return;
  const entry={name:f.name,type:f.type||'file',size:(f.size/1024).toFixed(1)+' KB',date:new Date().toLocaleString()};
  docs.push(entry);
  localStorage.setItem('docsList',JSON.stringify(docs));
  renderDocs();
});
function renderDocs(){
  docsTbody.innerHTML='';
  docs.forEach((d,i)=>{
    const r=document.createElement('tr');
    r.innerHTML=`<td contenteditable="true">${d.name}</td>
      <td>${d.type}</td><td>${d.size}</td><td>${d.date}</td>
      <td><button data-i="${i}" class="delBtn">🗑</button></td>`;
    docsTbody.appendChild(r);
  });
  docsTbody.querySelectorAll('.delBtn').forEach(b=>b.addEventListener('click',e=>{
    const i=e.target.dataset.i;docs.splice(i,1);
    localStorage.setItem('docsList',JSON.stringify(docs));renderDocs();
  }));
}
</script>
</body>
</html>
